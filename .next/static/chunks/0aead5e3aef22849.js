(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,29361,e=>{"use strict";let t,s,a,i;var n,r=e.i(96678),l=e.i(63676);let c=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,l.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:i="",children:n,iconNode:r,...d},m)=>(0,l.createElement)("svg",{ref:m,...o,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:c("lucide",i),...d},[...r.map(([e,t])=>(0,l.createElement)(e,t)),...Array.isArray(n)?n:[n]])),m=(e,t)=>{let s=(0,l.forwardRef)(({className:s,...a},i)=>(0,l.createElement)(d,{ref:i,iconNode:t,className:c(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...a}));return s.displayName=`${e}`,s},u=m("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),h=m("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),x=m("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]),p=m("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),g=e=>{let t,s=new Set,a=(e,a)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=a?a:"object"!=typeof i||null===i)?i:Object.assign({},t,i),s.forEach(s=>s(t,e))}},i=()=>t,n={setState:a,getState:i,getInitialState:()=>r,subscribe:e=>(s.add(e),()=>s.delete(e))},r=t=e(a,i,n);return n},f=e=>t=>{try{let s=e(t);if(s instanceof Promise)return s;return{then:e=>f(e)(s),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>f(t)(e)}}},y=(a=(n=(t=(e,t)=>({isPlaying:!1,currentTrack:null,currentStation:null,queue:[],volume:.7,crossfadeDuration:5,stations:[],voices:[],showSettings:!1,showVoiceSelector:!1,commentaryEnabled:!0,setCurrentTrack:t=>e({currentTrack:t}),setCurrentStation:t=>e({currentStation:t}),setIsPlaying:t=>e({isPlaying:t}),setVolume:t=>e({volume:t}),setCrossfadeDuration:t=>e({crossfadeDuration:t}),setQueue:t=>e({queue:t}),addToQueue:t=>e(e=>({queue:[...e.queue,t]})),nextTrack:()=>{let{queue:s}=t();if(s.length>0){let[t,...a]=s;e({currentTrack:t,queue:a})}},toggleSettings:()=>e(e=>({showSettings:!e.showSettings})),toggleVoiceSelector:()=>e(e=>({showVoiceSelector:!e.showVoiceSelector})),toggleCommentary:()=>e(e=>({commentaryEnabled:!e.commentaryEnabled})),addStation:t=>{e(e=>({stations:[...e.stations,t]}))},updateStation:(t,s)=>{e(e=>({stations:e.stations.map(e=>e.id===t?{...e,...s}:e)}))},removeStation:t=>{e(e=>({stations:e.stations.filter(e=>e.id!==t)}))},addVoice:t=>{e(e=>({voices:[...e.voices,t]}))},removeVoice:t=>{e(e=>({voices:e.voices.filter(e=>e.id!==t)}))},syncToCloud:async e=>{let{stations:s,voices:a}=t();try{await fetch("/api/stations/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,stations:s,voices:a})})}catch(e){console.warn("Cloud sync skipped (Supabase not configured)")}},loadFromCloud:async t=>{try{let[s,a]=await Promise.all([fetch(`/api/stations?userId=${t}`),fetch(`/api/voices?userId=${t}`)]);if(s.ok){let t=await s.json(),i=await a.json();e({stations:t.stations||[],voices:i.voices||[]})}}catch(e){console.warn("Cloud load skipped (Supabase not configured), using local data")}}}),s={name:"raydo-radio-storage",partialize:e=>({stations:e.stations,voices:e.voices,volume:e.volume,crossfadeDuration:e.crossfadeDuration,commentaryEnabled:e.commentaryEnabled})},(e,a,i)=>{let n,r={storage:function(e,t){let s;try{s=e()}catch(e){return}return{getItem:e=>{var t;let a=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=s.getItem(e))?t:null;return i instanceof Promise?i.then(a):a(i)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...s},l=!1,c=0,o=new Set,d=new Set,m=r.storage;if(!m)return t((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),e(...t)},a,i);let u=()=>{let e=r.partialize({...a()});return m.setItem(r.name,{state:e,version:r.version})},h=i.setState;i.setState=(e,t)=>(h(e,t),u());let x=t((...t)=>(e(...t),u()),a,i);i.getInitialState=()=>x;let p=()=>{var t,s;if(!m)return;let i=++c;l=!1,o.forEach(e=>{var t;return e(null!=(t=a())?t:x)});let h=(null==(s=r.onRehydrateStorage)?void 0:s.call(r,null!=(t=a())?t:x))||void 0;return f(m.getItem.bind(m))(r.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];else{if(r.migrate){let t=r.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(t=>{var s;if(i!==c)return;let[l,o]=t;if(e(n=r.merge(o,null!=(s=a())?s:x),!0),l)return u()}).then(()=>{i===c&&(null==h||h(n,void 0),n=a(),l=!0,d.forEach(e=>e(n)))}).catch(e=>{i===c&&(null==h||h(void 0,e))})};return i.persist={setOptions:e=>{r={...r,...e},e.storage&&(m=e.storage)},clearStorage:()=>{null==m||m.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>p(),hasHydrated:()=>l,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},r.skipHydration||p(),n||x}))?g(n):g,Object.assign(i=e=>(function(e,t=e=>e){let s=l.default.useSyncExternalStore(e.subscribe,l.default.useCallback(()=>t(e.getState()),[e,t]),l.default.useCallback(()=>t(e.getInitialState()),[e,t]));return l.default.useDebugValue(s),s})(a,e),a),i);function b(){let{showSettings:e,toggleSettings:t,commentaryEnabled:s,toggleCommentary:a,crossfadeDuration:i,setCrossfadeDuration:n,currentStation:c,updateStation:o}=y(),[d,m]=(0,l.useState)(c);return e?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-zinc-900 rounded-xl w-full max-w-md p-6 m-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white",children:"Settings"}),(0,r.jsx)("button",{onClick:t,className:"p-2 text-zinc-400 hover:text-white transition-colors",children:(0,r.jsx)(u,{size:20})})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("button",{onClick:a,className:"w-full flex items-center justify-between p-4 bg-zinc-800 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(h,{size:20,className:s?"text-white":"text-zinc-500"}),(0,r.jsx)("span",{className:"text-white",children:"AI Commentary"})]}),(0,r.jsx)("div",{className:`w-12 h-6 rounded-full transition-colors ${s?"bg-green-500":"bg-zinc-600"}`,children:(0,r.jsx)("div",{className:`w-5 h-5 rounded-full bg-white mt-0.5 transition-transform ${s?"translate-x-6":"translate-x-0.5"}`})})]})}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)(x,{size:20,className:"text-zinc-400"}),(0,r.jsx)("span",{className:"text-white",children:"Crossfade Duration"})]}),(0,r.jsx)("input",{type:"range",min:0,max:15,step:1,value:i,onChange:e=>n(parseFloat(e.target.value)),className:"w-full h-2 bg-zinc-700 rounded-lg appearance-none cursor-pointer accent-white"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-zinc-500 mt-1",children:[(0,r.jsx)("span",{children:"Instant"}),(0,r.jsxs)("span",{children:[i,"s"]}),(0,r.jsx)("span",{children:"15s"})]})]}),c&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:[c.name," Settings"]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{className:"block text-white text-sm mb-2",children:["Energy Level: ",Math.round(100*(d?.energyLevel||c.energyLevel)),"%"]}),(0,r.jsx)("input",{type:"range",min:0,max:1,step:.05,value:d?.energyLevel??c.energyLevel,onChange:e=>m({...d,energyLevel:parseFloat(e.target.value)}),className:"w-full h-2 bg-zinc-700 rounded-lg appearance-none cursor-pointer accent-white"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-zinc-500 mt-1",children:[(0,r.jsx)("span",{children:"Chill"}),(0,r.jsx)("span",{children:"Balanced"}),(0,r.jsx)("span",{children:"Hype"})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-white text-sm mb-2",children:"Commentary Style"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2",children:["chill","balanced","hype"].map(e=>(0,r.jsx)("button",{onClick:()=>m({...d,style:e}),className:`py-2 px-4 rounded-lg text-sm transition-colors ${(d?.style??c.style)===e?"bg-white text-black":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"}`,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"flex items-center justify-between p-3 bg-zinc-800 rounded-lg cursor-pointer",children:[(0,r.jsx)("span",{className:"text-white text-sm",children:"Include Messages"}),(0,r.jsx)("input",{type:"checkbox",checked:d?.includeMessages??c.includeMessages,onChange:e=>m({...d,includeMessages:e.target.checked}),className:"w-5 h-5 rounded border-zinc-600 bg-zinc-700 text-white focus:ring-white"})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between p-3 bg-zinc-800 rounded-lg cursor-pointer",children:[(0,r.jsx)("span",{className:"text-white text-sm",children:"Include Calendar"}),(0,r.jsx)("input",{type:"checkbox",checked:d?.includeCalendar??c.includeCalendar,onChange:e=>m({...d,includeCalendar:e.target.checked}),className:"w-5 h-5 rounded border-zinc-600 bg-zinc-700 text-white focus:ring-white"})]}),(0,r.jsxs)("label",{className:"flex items-center justify-between p-3 bg-zinc-800 rounded-lg cursor-pointer",children:[(0,r.jsx)("span",{className:"text-white text-sm",children:"Include News"}),(0,r.jsx)("input",{type:"checkbox",checked:d?.includeNews??c.includeNews,onChange:e=>m({...d,includeNews:e.target.checked}),className:"w-5 h-5 rounded border-zinc-600 bg-zinc-700 text-white focus:ring-white"})]})]})]}),(0,r.jsxs)("button",{onClick:()=>{d&&c?.id===d.id&&o(c.id,d)},className:"w-full flex items-center justify-center gap-2 py-3 bg-white text-black rounded-lg font-medium hover:bg-zinc-200 transition-colors",children:[(0,r.jsx)(p,{size:18}),"Save Settings"]})]})}):null}let v=m("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),j=m("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),w=m("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]),N=m("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]),k=m("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),z=m("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);function S(){let{isPlaying:e,currentTrack:t,queue:s,volume:a,setIsPlaying:i,setVolume:n,nextTrack:c}=y(),o=(0,l.useRef)(null),[d,m]=(0,l.useState)(!1),[u,h]=(0,l.useState)(0),[x,p]=(0,l.useState)(0),[g,f]=(0,l.useState)(void 0);(0,l.useEffect)(()=>{t?.previewUrl!==g&&f(t?.previewUrl)},[t]),(0,l.useEffect)(()=>{let t=o.current;if(!t)return;let s=()=>{c()},a=()=>{e&&t.play().catch(e=>console.log("Auto-play blocked:",e))};return t.addEventListener("ended",s),t.addEventListener("canplay",a),()=>{t.removeEventListener("ended",s),t.removeEventListener("canplay",a)}},[c,e]),(0,l.useEffect)(()=>{o.current&&(o.current.volume=d?0:a)},[a,d]),(0,l.useEffect)(()=>{let e=o.current;if(!e)return;let t=()=>{h(e.currentTime),p(e.duration||0)};return e.addEventListener("timeupdate",t),e.addEventListener("loadedmetadata",t),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("loadedmetadata",t)}},[]);let b=async()=>{if(!o.current)return void i(!e);try{e?o.current.pause():await o.current.play(),i(!e)}catch(e){console.log("Play error:",e),o.current.load(),setTimeout(async()=>{try{await o.current?.play(),i(!0)}catch(e){console.log("Retry play failed:",e)}},100)}},S=e=>{let t=Math.floor(e/60),s=Math.floor(e%60);return`${t}:${s.toString().padStart(2,"0")}`},C=t||(s.length>0?s[0]:null);return(0,r.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 bg-zinc-900 border-t border-zinc-800 p-4 z-50",children:[(0,r.jsx)("audio",{ref:o,src:g,preload:"auto"}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[C?.artworkUrl&&(0,r.jsx)("img",{src:C.artworkUrl,alt:C.title,className:"w-16 h-16 rounded-lg object-cover",onError:e=>{e.target.style.display="none"}}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-white font-medium",children:C?.title||"No track playing"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:C?.artistName||"Select a station to start"}),C?.spotifyUri&&(0,r.jsxs)("a",{href:C.spotifyUri,className:"text-[#1DB954] text-xs hover:underline flex items-center gap-1 mt-1",children:[(0,r.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})}),"Open in Spotify"]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("input",{type:"range",min:0,max:x||100,value:u,onChange:e=>{let t=parseFloat(e.target.value);o.current&&(o.current.currentTime=t),h(t)},className:"w-full h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer accent-white"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-zinc-500 mt-1",children:[(0,r.jsx)("span",{children:S(u)}),(0,r.jsx)("span",{children:S(x)})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>{s.length>0&&i(!0)},className:"p-2 text-zinc-400 hover:text-white transition-colors",children:(0,r.jsx)(N,{size:20})}),(0,r.jsx)("button",{onClick:b,className:"p-3 bg-white rounded-full text-black hover:bg-zinc-200 transition-colors flex items-center justify-center",children:e?(0,r.jsx)(j,{size:24,fill:"currentColor"}):(0,r.jsx)(v,{size:24,fill:"currentColor"})}),(0,r.jsx)("button",{onClick:()=>{c()},className:"p-2 text-zinc-400 hover:text-white transition-colors",children:(0,r.jsx)(w,{size:20})})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>m(!d),className:"p-2 text-zinc-400 hover:text-white transition-colors",children:d?(0,r.jsx)(z,{size:20}):(0,r.jsx)(k,{size:20})}),(0,r.jsx)("input",{type:"range",min:0,max:1,step:.1,value:d?0:a,onChange:e=>n(parseFloat(e.target.value)),className:"w-24 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer accent-white"})]})]})]})}function C({isPlaying:e}){let t=(0,l.useRef)(null),s=(0,l.useRef)();return(0,l.useEffect)(()=>{let a=t.current;if(!a)return;let i=a.getContext("2d");if(!i)return;let n=a.width/64-2,r=()=>{if(!e){i.fillStyle="#18181b",i.fillRect(0,0,a.width,a.height),s.current=requestAnimationFrame(r);return}i.fillStyle="rgba(24, 24, 27, 0.2)",i.fillRect(0,0,a.width,a.height);for(let e=0;e<64;e++){let t=Date.now()/1e3,s=30*Math.sin(2*t+.3*e)+20*Math.sin(3*t+.5*e)+30*Math.random()+20,r=(5*e+20*t)%360,l=e*(n+2),c=a.height-s;i.fillStyle=`hsla(${r}, 70%, 60%, 0.8)`,i.fillRect(l,c,n,s),i.shadowBlur=10,i.shadowColor=`hsla(${r}, 70%, 60%, 0.5)`}s.current=requestAnimationFrame(r)};return r(),()=>{s.current&&cancelAnimationFrame(s.current)}},[e]),(0,r.jsx)("canvas",{ref:t,width:800,height:200,className:"w-full h-48 rounded-xl",style:{background:"#18181b"}})}var I=e.i(60577);let E=(0,l.createContext)(null);function A({children:e}){let{setQueue:t,setCurrentTrack:s,setIsPlaying:a}=y(),[i,n]=(0,l.useState)(null),[c,o]=(0,l.useState)(!1),[d,m]=(0,l.useState)([]),[u,h]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("spotify_access_token"),t=localStorage.getItem("spotify_token_expiry");e&&t&&Date.now()<parseInt(t)&&(h(e),x(e));let s=new URLSearchParams(window.location.search),a=s.get("spotify_token"),i=s.get("spotify_expires");a&&i&&(localStorage.setItem("spotify_access_token",a),localStorage.setItem("spotify_token_expiry",String(Date.now()+1e3*parseInt(i))),h(a),x(a),window.history.replaceState({},"","/"))},[]);let x=async e=>{try{let t=await fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let s=await t.json();n(s),p(e)}else f()}catch(e){console.error("Failed to fetch Spotify profile:",e)}},p=async e=>{try{let t=await fetch("https://api.spotify.com/v1/me/playlists?limit=20",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();m(e.items||[])}}catch(e){console.error("Failed to fetch playlists:",e)}},g=()=>{let e=I.default.env.NEXT_PUBLIC_SPOTIFY_CLIENT_ID,t=`${window.location.origin}/api/spotify/callback`,s=`https://accounts.spotify.com/authorize?client_id=${e}&response_type=token&redirect_uri=${encodeURIComponent(t)}&scope=${encodeURIComponent("user-read-email user-read-private playlist-read-private playlist-read-collaborative streaming user-library-read")}`;window.location.href=s},f=()=>{localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_token_expiry"),h(null),n(null),m([])},b=async e=>{if(!u)return[];try{let t=await fetch(`https://api.spotify.com/v1/playlists/${e}/tracks?limit=50`,{headers:{Authorization:`Bearer ${u}`}});if(t.ok)return(await t.json()).items.filter(e=>e.track&&e.track.preview_url).map(e=>e.track)}catch(e){console.error("Failed to fetch tracks:",e)}return[]},v=async e=>{if(!u||!i)return void g();o(!0);try{let i=await fetch(`https://api.spotify.com/v1/recommendations?seed_genres=${{chill:["chill","lo-fi","ambient"],hype:["hip-hop","party","electronic"],balanced:["pop","indie","acoustic"]}[e][0]}&limit=20`,{headers:{Authorization:`Bearer ${u}`}});if(i.ok){let e=(await i.json()).tracks.filter(e=>e.preview_url).map(e=>({id:e.id,title:e.name,artistName:e.artists.map(e=>e.name).join(", "),albumName:e.album.name,artworkUrl:e.album.images[0]?.url||"",duration:Math.floor(e.duration_ms/1e3),previewUrl:e.preview_url,spotifyUri:e.uri}));t(e),s(e[0]),a(!0)}}catch(e){console.error("Failed to create radio:",e)}finally{o(!1)}};return(0,r.jsx)(E.Provider,{value:{user:i,isAuthenticated:!!i&&!!u,isLoading:c,playlists:d,connectSpotify:g,disconnect:f,getPlaylistTracks:b,createRadioStation:v},children:e})}function _(){let{user:e,isAuthenticated:t,playlists:s,connectSpotify:a,createRadioStation:i,isLoading:n}=function(){let e=(0,l.useContext)(E);if(!e)throw Error("useSpotify must be used within SpotifyProvider");return e}(),{isPlaying:c,currentTrack:o}=y(),[d,m]=(0,l.useState)("balanced");return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-8 p-4 bg-zinc-900/50 rounded-xl flex items-center gap-4",children:[e?.images?.[0]&&(0,r.jsx)("img",{src:e.images[0].url,alt:e.display_name,className:"w-12 h-12 rounded-full"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Signed in as"}),(0,r.jsx)("p",{className:"text-white font-medium",children:e?.display_name})]}),(0,r.jsx)("button",{onClick:()=>window.location.href="/api/spotify/disconnect",className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 rounded-lg text-sm",children:"Disconnect"})]}),(0,r.jsxs)("div",{className:"mb-8 p-6 bg-zinc-900/50 rounded-xl",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"ðŸŽµ Create AI Radio Station"}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm mb-4",children:"Select a mood and the AI DJ will weave commentary between songs from your Spotify library"}),(0,r.jsx)("div",{className:"flex gap-3 mb-4",children:["chill","balanced","hype"].map(e=>(0,r.jsxs)("button",{onClick:()=>m(e),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d===e?"bg-purple-500 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"}`,children:["chill"===e&&"ðŸŒ€ Chill","balanced"===e&&"âš–ï¸ Balanced","hype"===e&&"âš¡ Hype"]},e))}),(0,r.jsx)("button",{onClick:()=>i(d),disabled:n,className:"w-full py-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-400 hover:to-pink-400 text-white font-semibold rounded-lg transition-colors disabled:opacity-50",children:n?"Creating Station...":"ðŸš€ Start AI Radio"})]}),s.length>0&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"ðŸ“š Your Playlists"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.slice(0,8).map(e=>(0,r.jsxs)("div",{className:"p-4 bg-zinc-900/50 rounded-xl hover:bg-zinc-800 transition-colors cursor-pointer group",children:[e.images[0]&&(0,r.jsx)("img",{src:e.images[0].url,alt:e.name,className:"w-full aspect-square object-cover rounded-lg mb-3"}),(0,r.jsx)("p",{className:"text-white font-medium truncate",children:e.name}),(0,r.jsxs)("p",{className:"text-zinc-500 text-sm",children:[e.tracks.total," tracks"]})]},e.id))})]}),o&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-zinc-900/50 rounded-xl flex items-center gap-4",children:[o.artworkUrl&&(0,r.jsx)("img",{src:o.artworkUrl,alt:o.title,className:"w-16 h-16 rounded-lg"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-white font-medium",children:o.title}),(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:o.artistName})]}),(0,r.jsx)("div",{className:`w-3 h-3 rounded-full ${c?"bg-green-400 animate-pulse":"bg-zinc-500"}`})]})]}):(0,r.jsx)("div",{className:"mb-8 p-6 bg-gradient-to-r from-green-500/10 to-green-600/10 border border-green-500/20 rounded-xl",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-green-400 mb-1",children:"ðŸŽ§ Connect Spotify"}),(0,r.jsx)("p",{className:"text-zinc-400",children:"Sign in with Spotify to stream real music and create personalized radio stations"})]}),(0,r.jsx)("button",{onClick:a,className:"px-6 py-3 bg-[#1DB954] hover:bg-[#1ed760] text-black font-semibold rounded-lg transition-colors",children:"Connect Spotify"})]})})}function L(){let{toggleSettings:e,commentaryEnabled:t,isPlaying:s}=y(),[a,i]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{let e=setTimeout(()=>i(!1),1e3);return()=>clearTimeout(e)},[]),a)?(0,r.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-zinc-800 border-t-white rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-zinc-400",children:"Loading RAY.DO..."})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,r.jsx)("header",{className:"sticky top-0 z-10 bg-black/80 backdrop-blur-lg border-b border-zinc-800",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xl",children:"ðŸŽµ"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"RAY.DO"}),(0,r.jsx)("p",{className:"text-xs text-zinc-500",children:"AI Radio DJ with Spotify"})]})]}),(0,r.jsx)("button",{onClick:e,className:"p-2 text-zinc-400 hover:text-white transition-colors",children:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})}),(0,r.jsxs)("main",{className:"max-w-6xl mx-auto px-6 py-8 pb-32",children:[(0,r.jsx)(_,{}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(C,{isPlaying:s})}),(0,r.jsxs)("div",{className:"mt-12 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 bg-zinc-900 rounded-lg",children:[(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Currently Playing"}),(0,r.jsx)("p",{className:"text-white font-medium mt-1",children:"AI Radio Station"})]}),(0,r.jsxs)("div",{className:"p-4 bg-zinc-900 rounded-lg",children:[(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"AI Commentary"}),(0,r.jsx)("p",{className:"text-white font-medium mt-1",children:"Weaving between tracks"})]}),(0,r.jsxs)("div",{className:"p-4 bg-zinc-900 rounded-lg",children:[(0,r.jsx)("p",{className:"text-zinc-400 text-sm",children:"Music Source"}),(0,r.jsx)("p",{className:"text-white font-medium mt-1",children:"Your Spotify Library"})]})]})]}),(0,r.jsx)(S,{}),(0,r.jsx)(b,{})]})}function $(){return(0,r.jsx)(A,{children:(0,r.jsx)(L,{})})}e.s(["default",()=>$],29361)}]);